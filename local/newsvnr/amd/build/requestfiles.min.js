define(["jquery","core/config","core/str","kendo.all.min"],function(e,t,n,a){var i=t.wwwroot+"/local/newsvnr/ajax/requestfiles_generallibrary.php",l=function(){n.get_strings([{key:"acceptfile",component:"local_newsvnr"},{key:"filename",component:"local_newsvnr"},{key:"filetype",component:"local_newsvnr"},{key:"filesize",component:"local_newsvnr"},{key:"filetimecreated",component:"local_newsvnr"},{key:"fileauthor",component:"local_newsvnr"},{key:"download",component:"local_newsvnr"},{key:"filepath",component:"local_newsvnr"}]).then(function(t){var n=[{selectable:!0,width:"50px"},{template:function(e){return e.filename},field:"filename",title:t[1],width:"500px"},{field:"filepath",title:t[7],width:"200px"},{field:"filetype",title:t[2],width:"100px"},{field:"filesize",title:t[3],width:"120px"},{template:function(e){return e.download},field:"download",title:t[6],width:"100px"},{field:"timecreated",title:t[4],width:"120px"},{field:"author",title:t[5],width:"200px"},{template:function(e){return e.listbtn},field:"listbtn",title:t[0],width:"100px"}];return e("#requestfile_grid").kendoGrid({dataSource:{transport:{read:{url:i,data:{action:"requestfiles"},dataType:"json",contentType:"application/json; charset=utf-8",type:"GET"},parameterMap:function(e,t){if("read"==t)return e.filter&&(e.q=e.filter.filters[0].value),e}},schema:{total:function(e){if(null!=e&&e.length>0)return e[0].total}},pageSize:10,serverPaging:!0,serverFiltering:!0,serverSorting:!0},toolbar:["search"],search:{fields:["filename"]},height:600,sortable:!1,reorderable:!0,groupable:!1,resizable:!0,filterable:!0,columnMenu:!0,pageable:{refresh:!0,pageSizes:!0,buttonCount:5},columns:n})})};return{init:function(){e("[data-key=requestaccecpt]").click(function(){l()}),e("[data-key=rolepermissionsmanage]").click(function(){n.get_strings([{key:"name",component:"local_newsvnr"},{key:"gl_listuser",component:"local_newsvnr"},{key:"gl_viewlistuser",component:"local_newsvnr"}]).then(function(t){var n=[{template:function(e){return e.name},field:"name",title:t[0],width:500},{command:[{name:"listuser",template:t[1]+" <a class='k-button k-grid-listuser'><span class='k-icon k-i-zoom mr-1'></span>"+t[2]+"</a>",click(n){n.preventDefault();var l=this.dataItem(e(n.currentTarget).closest("tr")),r=e("#md-viewlistuser"),o={type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{action:"listuser",capability:l.name_raw}};r.kendoWindow({width:"450px",title:t[2],modal:!0,open:function(t){a.ui.progress(e(r),!0),e.ajax(i,o).then(function(t){r.data("kendoWindow").content(t.success),a.ui.progress(e(r),!1)}),t.sender.center()}}),r.data("kendoWindow").open()}}],width:400}];e("#rolepermissionsmanage_grid").kendoGrid({dataSource:{transport:{read:{url:i,data:{action:"listrole"},dataType:"json",contentType:"application/json; charset=utf-8",type:"GET"}}},resizable:!0,columns:n})})})},refreshGrid:function(){return l(),"OK"},acceptFile:function(n){var a=t.wwwroot+"/local/newsvnr/ajax/requestfiles_generallibrary.php",i={type:"GET",processData:!0,data:{action:"acceptfile",id:n}};e.ajax(a,i).then(function(e){})},deleteFile:function(n,a){var i=t.wwwroot+"/local/newsvnr/ajax/requestfiles_generallibrary.php",l={type:"GET",processData:!0,data:{action:"deletefile",filename:n,filepath:a}};e.ajax(i,l).then(function(e){})}}});