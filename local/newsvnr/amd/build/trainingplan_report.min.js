define(["jquery","core/config","validatefm","local_newsvnr/initkendogrid","alertjs","core/str","kendo.all.min","local_newsvnr/initkendocontrolservices"],function(t,e,r,i,n,o,a,s){"use strict";let l="#trainingplan_report",c={},u=e.wwwroot+"/local/newsvnr/report/ajax/trainingplan_report.php";var p=function(e){var r={url:u,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:e},n=[{template:function(t){return t.name},field:"name",title:M.util.get_string("studentname","local_newsvnr"),width:"100px"},{field:"routename",title:M.util.get_string("currentplan","local_newsvnr"),width:"120px"},{template:"<div class='d-flex participants-collum'><div class='progress course'><div class='progress-bar' role='progressbar' aria-valuenow='#: process #' aria-valuemin='0' aria-valuemax='100' style='width:#: process #%'></div></div><div></div></div></div>",field:"process",title:M.util.get_string("progress","local_newsvnr"),width:"100px"},{template:function(t){return'<span class="badge text-white '+t.classstatus+' font-weight-bold rounded p-2">'+t.status+"</span>"},field:"status",title:M.util.get_string("status","local_newsvnr"),width:"100px"},{field:"timecompleted",title:M.util.get_string("timefinishcourse","local_newsvnr"),width:"70px"}];c.toolbar=["excel"],c.excel={fileName:"trainingplan_report.xlsx",allPages:!0},c.columns=n,c.apiSettings=r;var o=i.initGrid(c);t(l).data("kendoGrid")&&t(l).data("kendoGrid").destroy(),t(l).kendoGrid(o)};return{init:function(){p(),t("#searchorgs").click(function(){!function(t,e){p({action:"searchorgstructure",orgstructureid:t,positionid:e})}(t("#orgstructure").val(),t("#orgstructure_position").val())}),t("#searchaccount").click(function(){var e=t("#username").val(),r=t("#route").val(),i=t("#start_timeaccess").val(),n=parseInt((new Date(i).getTime()/1e3).toFixed(0)),o=t("#end_timeaccess").val();!function(t,e,r,i,n,o,a){p({action:"searchaccount",username:t,route:e,datestart:r,dateend:i,status:n,startprocess:o,endprocess:a})}(e,r,n,parseInt((new Date(o).getTime()/1e3).toFixed(0)),t("#status").val(),t("#start_process").val(),t("#end_process").val())}),t("#resettable").click(function(){p()}),t("#exporttable").click(function(){t(".k-grid-excel").click()})},kendoDropdown:function(){var e="/local/newsvnr/report/ajax/report_data.php?action=";t("#start_timeaccess").kendoDatePicker({change:function(){t("#end_timeaccess").val("");var e=t("#start_timeaccess").val().split("/");if(e.length>1){var r=t("#end_timeaccess").data("kendoDatePicker"),i=parseInt(e[2]),n=parseInt(e[0]),o=parseInt(e[1]);r.setOptions({min:new Date(i,n-1,o+1)})}}}),t("#end_timeaccess").kendoDatePicker(),(a={}).apiSettings={url:e+"get_orgstructure_category"},a.value="categoryid",a.optionLabel=M.util.get_string("selectorgstructuretype","local_newsvnr");var r=s.initDropDownList(a);t("#orgstructure_category").kendoDropDownList(r),(a={}).apiSettings={url:e+"get_orgstructure"},a.value="orgid",a.optionLabel=M.util.get_string("selectorgstructure","local_newsvnr"),a.cascadeFrom="orgstructure_category";var i=s.initDropDownList(a);t("#orgstructure").kendoDropDownList(i),(a={}).apiSettings={url:e+"get_orgstructure_jobtitle"},a.value="jobtitleid",a.optionLabel=M.util.get_string("selectjobtitle","local_newsvnr");var n=s.initDropDownList(a);t("#orgstructure_jobtitle").kendoDropDownList(n),(a={}).apiSettings={url:e+"get_orgstructure_position"},a.value="positionid",a.optionLabel=M.util.get_string("selectjobposition","local_newsvnr"),a.cascadeFrom="orgstructure_jobtitle";var o=s.initDropDownList(a);t("#orgstructure_position").kendoDropDownList(o),(a={}).apiSettings={url:e+"get_learning_status"},a.value="value",a.optionLabel=M.util.get_string("select","local_newsvnr");var a,l=s.initDropDownList(a);t("#status").kendoDropDownList(l),(a={}).apiSettings={url:e+"get_route"},a.value="value",a.optionLabel=M.util.get_string("select","local_newsvnr");var c=s.initDropDownList(a);t("#route").kendoDropDownList(c),t("#start_process").kendoNumericTextBox({format:"p0",factor:100,min:0,max:1,step:.01}),t("#end_process").kendoNumericTextBox({format:"p0",factor:100,min:0,max:1,step:.01})}}});