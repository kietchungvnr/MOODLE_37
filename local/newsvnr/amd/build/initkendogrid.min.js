define(["jquery","core/config","core/str","kendo.all.min","alertjs"],function(e,t,r,n,a){var s=function(e){return new n.data.DataSource({transport:{read:e.apiSettings,parameterMap:function(e,t){if("read"==t)return e.filter&&(e.q=e.filter.filters[0].value),e}},pageSize:10,serverPaging:!0,serverFiltering:!0,serverSorting:!0,schema:{model:{id:"id",fields:{id:{type:"number"},name:{type:"string"}}},total:function(e){if(null!=e&&e.length>0)return e[0].total}}})};return{initGrid:function(r){if(eventArr=[],void 0===r.columns&&(r.columns=[]),r.selectData=function(t){for(var n=e("div[kendo-grid][k-options="+r.gridName+"]").getKendoGrid(),a=n.select(),s=[],i=0;i<a.length;i++)s.push(n.dataItem(a[i]));return s},r.selectId=function(t){for(var n=e("div[kendo-grid][k-options="+r.gridName+"]").getKendoGrid(),a=n.select(),s=[],i=0;i<a.length;i++)s.push(n.dataItem(a[i]).Id);return s},void 0===r.selectable&&r.columns.unshift({selectable:!0,width:50}),null!=r.approvalModuleEvent){var n={click:function(n){n.preventDefault();var s=this.dataItem(e(n.currentTarget).closest("tr")),i=t.wwwroot+"/local/newsvnr/ajax/library_online/library_approval_module_ajax.php?action=approval",o={type:"GET",processData:!0,dataType:"json",contentType:"application/json",data:{moduleid:s.id}};e.ajax(i,o).then(function(e){1==e.error?a.error(e.message,"error",3):a.success(e.message,"success",3)}),r.approvalModuleEvent(s)},text:" ",name:"approval",iconClass:"fa fa-check"};eventArr.push(n)}if(null!=r.viewCourseInfoPopupEvent){var i={click:function(t){t.preventDefault();var n=this.dataItem(e(t.currentTarget).closest("tr"));r.viewCourseInfoPopupEvent(n)},text:M.util.get_string("viewcourse","local_newsvnr"),name:M.util.get_string("viewcourse","local_newsvnr"),iconClass:""};eventArr.push(i)}if(null!=r.deleteModuleEvent){var o={click:function(n){n.preventDefault();var s=this.dataItem(e(n.currentTarget).closest("tr")),i=t.wwwroot+"/local/newsvnr/ajax/library_online/library_approval_module_ajax.php?action=reject",o={type:"GET",processData:!0,dataType:"json",contentType:"application/json",data:{moduleid:s.id}};e.ajax(i,o).then(function(e){1==e.error?a.error(e.message,"error",3):a.success(e.message,"success",3)}),r.deleteModuleEvent(s)},text:" ",name:"delete",iconClass:"fa fa-trash"};eventArr.push(o)}if(null!=r.editEvent){var l={click:function(t){t.preventDefault();var n=this.dataItem(e(t.currentTarget).closest("tr"));r.editEvent(n)},text:" ",name:"edit",iconClass:"fa fa-pencil-square-o"};eventArr.push(l)}if(null!=r.deleteEvent){var c={click:function(t){t.preventDefault();var n=this.dataItem(e(t.currentTarget).closest("tr"));r.deleteEvent(n)},text:" ",name:"delete",iconClass:"fa fa-trash-o"};eventArr.push(c)}if(null!=r.deleteUserEvent){var u={click:function(n){n.preventDefault();var s=this.dataItem(e(n.currentTarget).closest("tr")),i=t.wwwroot+"/local/newsvnr/report/ajax/userreport_action.php",o={type:"GET",processData:!0,data:{userid:s.id,action:"delete"}};a.confirm(M.util.get_string("alert","local_newsvnr"),M.util.get_string("deleteuserconfirm","local_newsvnr"),function(){e.ajax(i,o).then(function(){var t=e.parseJSON(response);a.notify(t.result,"success",3)}),r.deleteUserEvent(s)},function(){}).set("labels",{ok:M.util.get_string("yes","local_newsvnr"),cancel:M.util.get_string("no","local_newsvnr")})},iconClass:"fa fa-trash mr-1",text:"",name:"deleteuser"};eventArr.push(u)}if(null!=r.hideUserEvent){var v="",d={click:function(n){n.preventDefault();var s={type:"GET",processData:!0,data:{userid:(v=this.dataItem(e(n.currentTarget).closest("tr"))).id,action:"hide"}},i=t.wwwroot+"/local/newsvnr/report/ajax/userreport_action.php";e.ajax(i,s).then(function(t){var r=e.parseJSON(t);a.notify(r.result,"success",3)}),r.hideUserEvent(v)},iconClass:"fa fa-eye mr-1",text:"",name:"hideuser",visible:function(e){return 0==e.suspended}};eventArr.push(d)}if(null!=r.showUserEvent){v="";var p={click:function(n){n.preventDefault();var s={type:"GET",processData:!0,data:{userid:(v=this.dataItem(e(n.currentTarget).closest("tr"))).id,action:"show"}},i=t.wwwroot+"/local/newsvnr/report/ajax/userreport_action.php";e.ajax(i,s).then(function(t){var r=e.parseJSON(t);a.notify(r.result,"success",3)}),r.showUserEvent(v)},iconClass:"fa fa-eye-slash mr-1",text:"",name:"showuser",visible:function(e){return 1==e.suspended}};eventArr.push(p)}if(null!=r.editUserEvent){var f={click:function(n){n.preventDefault();var a=this.dataItem(e(n.currentTarget).closest("tr"));window.open(t.wwwroot+"/user/editadvanced.php?id="+a.id+"&course=1&returnto=userreport"),r.editUserEvent(a)},iconClass:"fa fa-cog mr-1",text:"",name:"edituser"};eventArr.push(f)}if(null!=r.deleteDivisionEvent){var h={click:function(n){n.preventDefault();var s=this.dataItem(e(n.currentTarget).closest("tr")),i=t.wwwroot+"/local/newsvnr/division/ajax/division_action.php",o={type:"GET",processData:!0,data:{divisionid:s.id,action:"delete"}};e.ajax(i,o).then(function(){var t=e.parseJSON(response);a.notify(t.result,"success",3)}),r.deleteDivisionEvent(s)},iconClass:"fa fa-trash mr-1",text:"",name:"deletedivision"};eventArr.push(h)}if(null!=r.editDivisionEvent){var m={click:function(t){t.preventDefault();var n=this.dataItem(e(t.currentTarget).closest("tr"));r.editDivisionEvent(n)},iconClass:"fa fa-cog mr-1",text:"",name:"editdivision"};eventArr.push(m)}return eventArr.length>0&&r.columns.push({title:M.util.get_string("action","local_newsvnr"),command:eventArr,width:150}),void 0===r.toolbar&&(r.toolbar=["search"]),{dataSource:s(r),persistSelection:!0,groupable:!1,resizable:!0,change:r.onChange,toolbar:r.toolbar,excel:r.excel,search:{fields:["name"]},pageable:{refresh:!0,pageSizes:!0,pageSizes:[10,20,50,100],buttonCount:5},columns:r.columns,noRecords:{template:'<span class="grid-empty">'+M.util.get_string("emptydata","local_newsvnr")+"</span>"}}}}});