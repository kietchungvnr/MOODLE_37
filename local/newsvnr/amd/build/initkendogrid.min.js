define(["jquery","core/config","core/str","kendo.all.min","alertjs"],function(e,t,r,a,n){var s=function(e){return new a.data.DataSource({transport:{read:e.apiSettings,parameterMap:function(e,t){if("read"==t)return e.filter&&(e.q=e.filter.filters[0].value),e}},pageSize:10,serverPaging:!0,serverFiltering:!0,serverSorting:!0,schema:{model:{id:"id",fields:{id:{type:"number"},name:{type:"string"}}},total:function(e){if(null!=e&&e.length>0)return e[0].total}}})};return{initGrid:function(r){if(eventArr=[],void 0===r.columns&&(r.columns=[]),r.selectData=function(t){for(var a=e("div[kendo-grid][k-options="+r.gridName+"]").getKendoGrid(),n=a.select(),s=[],i=0;i<n.length;i++)s.push(a.dataItem(n[i]));return s},r.selectId=function(t){for(var a=e("div[kendo-grid][k-options="+r.gridName+"]").getKendoGrid(),n=a.select(),s=[],i=0;i<n.length;i++)s.push(a.dataItem(n[i]).Id);return s},void 0===r.selectable&&r.columns.unshift({selectable:!0,width:30}),null!=r.approvalModuleEvent){var a={click:function(a){a.preventDefault();var n=this.dataItem(e(a.currentTarget).closest("tr")),s=t.wwwroot+"/local/newsvnr/ajax/library_online/library_approval_module_ajax.php?action=approval",i={type:"POST",processData:!0,data:{moduleid:n.id}};e.ajax(s,i).then(function(){}),r.approvalModuleEvent(n)},text:" ",name:"approval",iconClass:"fa fa-check"};eventArr.push(a)}if(null!=r.viewCourseInfoPopupEvent){var i={click:function(t){t.preventDefault();var a=this.dataItem(e(t.currentTarget).closest("tr"));r.viewCourseInfoPopupEvent(a)},text:M.util.get_string("viewcourse","local_newsvnr"),name:M.util.get_string("viewcourse","local_newsvnr"),iconClass:""};eventArr.push(i)}if(null!=r.deleteModuleEvent){var o={click:function(a){a.preventDefault();var n=this.dataItem(e(a.currentTarget).closest("tr")),s=t.wwwroot+"/local/newsvnr/ajax/library_online/library_approval_module_ajax.php?action=delete",i={type:"POST",processData:!0,data:{moduleid:n.id}};e.ajax(s,i).then(function(){}),r.deleteModuleEvent(n)},text:" ",name:"delete",iconClass:"fa fa-trash"};eventArr.push(o)}if(null!=r.editEvent){var l={click:function(t){t.preventDefault();var a=this.dataItem(e(t.currentTarget).closest("tr"));r.editEvent(a)},text:" ",name:"edit",iconClass:"fa fa-pencil-square-o"};eventArr.push(l)}if(null!=r.deleteEvent){var c={click:function(t){t.preventDefault();var a=this.dataItem(e(t.currentTarget).closest("tr"));r.deleteEvent(a)},text:" ",name:"delete",iconClass:"fa fa-trash-o"};eventArr.push(c)}if(null!=r.joinCourseEvent){var u={click:function(t){t.preventDefault();var a=this.dataItem(e(t.currentTarget).closest("tr"));r.joinCourseEvent(a)},iconClass:"fa fa-arrow-right mr-1",text:M.util.get_string("startlearning","local_newsvnr"),name:"learning"};eventArr.push(u)}if(null!=r.deleteUserEvent){var d={click:function(a){a.preventDefault();var s=this.dataItem(e(a.currentTarget).closest("tr")),i=t.wwwroot+"/local/newsvnr/report/ajax/userreport_action.php",o={type:"GET",processData:!0,data:{userid:s.id,action:"delete"}};e.ajax(i,o).then(function(){var t=e.parseJSON(response);n.notify(t.result,"success",3)}),r.deleteUserEvent(s)},iconClass:"fa fa-trash mr-1",text:"",name:"deleteuser"};eventArr.push(d)}if(null!=r.hideUserEvent){var v="",p={click:function(a){a.preventDefault();var s={type:"GET",processData:!0,data:{userid:(v=this.dataItem(e(a.currentTarget).closest("tr"))).id,action:"hide"}},i=t.wwwroot+"/local/newsvnr/report/ajax/userreport_action.php";e.ajax(i,s).then(function(t){var r=e.parseJSON(t);n.notify(r.result,"success",3)}),r.hideUserEvent(v)},iconClass:"fa fa-eye mr-1",text:"",name:"hideuser",visible:function(e){return 0==e.suspended}};eventArr.push(p)}if(null!=r.showUserEvent){v="";var f={click:function(a){a.preventDefault();var s={type:"GET",processData:!0,data:{userid:(v=this.dataItem(e(a.currentTarget).closest("tr"))).id,action:"show"}},i=t.wwwroot+"/local/newsvnr/report/ajax/userreport_action.php";e.ajax(i,s).then(function(t){var r=e.parseJSON(t);n.notify(r.result,"success",3)}),r.showUserEvent(v)},iconClass:"fa fa-eye-slash mr-1",text:"",name:"showuser",visible:function(e){return 1==e.suspended}};eventArr.push(f)}if(null!=r.editUserEvent){var h={click:function(a){a.preventDefault();var n=this.dataItem(e(a.currentTarget).closest("tr"));window.open(t.wwwroot+"/user/editadvanced.php?id="+n.id+"&course=1"),r.editUserEvent(n)},iconClass:"fa fa-cog mr-1",text:"",name:"edituser"};eventArr.push(h)}return eventArr.length>0&&r.columns.push({title:M.util.get_string("action","local_newsvnr"),command:eventArr,width:150}),void 0===r.toolbar&&(r.toolbar=["search"]),{dataSource:s(r),persistSelection:!0,groupable:!1,resizable:!0,change:r.onChange,toolbar:r.toolbar,excel:r.excel,search:{fields:["name"]},pageable:{refresh:!0,pageSizes:!0,pageSizes:[10,20,50,100],buttonCount:5},columns:r.columns,noRecords:{template:'<span class="grid-empty">'+M.util.get_string("emptydata","local_newsvnr")+"</span>"}}}}});