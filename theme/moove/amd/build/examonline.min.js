define(["jquery","core/config","kendo.all.min","core/str","core/notification","local_newsvnr/initkendocontrolservices"],function(i,l,e,a,t,r){var m=l.wwwroot+"/local/newsvnr/exam/ajax/examonline.php",n=l.wwwroot+"/examonline.php",s=l.wwwroot+"/local/newsvnr/exam/ajax/exam_grade_report.php";window.location.href==n&&(i.getJSON(m,function(e){i("#table-exam").hide().html(e.result).fadeIn("fast")}),i.getJSON(m+"?action=exam_category",function(e){i("#examonline-category").hide().html(e.category_exam).fadeIn("fast")})),a.get_strings([{key:"listexamrequired",component:"local_newsvnr"},{key:"listexamfree",component:"local_newsvnr"},{key:"subjectexam",component:"local_newsvnr"},{key:"exam",component:"local_newsvnr"}]).then(function(o){function t(){var e=i("#exam-type").val(),a={},t={url:s,data:{action:1==e?"exam_filter_free":"exam_filter_required"}};a.optionLabel=o[3]+"...",a.apiSettings=t,a.value="examid";var n=r.initDropDownList(a);i("#examname").kendoDropDownList(n)}function n(){var e=i("#exam-type").val(),a={},t={url:s,data:{action:1==e?"subject_filter_free":"subject_filter_required"}};a.cascadeFrom="examname",a.optionLabel=o[2]+"...",a.apiSettings=t,a.value="examsubjectexamid";var n=r.initDropDownList(a);i("#subjectname").kendoDropDownList(n)}i("#examdate").kendoDatePicker(),i("#exam_search_button").click(function(){var e=i("#examdate").val(),a=parseInt((new Date(e).getTime()/1e3).toFixed(0)),t=i("#examname").val(),n=i("#subjectname").val(),o=i("#exam-type").val();i("li").removeClass("active"),i.getJSON(m+"?examid="+t+"&examsubjectexamid="+n+"&date="+a+"&examtype="+o,function(e){i("#table-exam").hide().html(e.result).fadeIn("fast"),i(".loading-page").removeClass("active")})}),i("#exam-type").kendoDropDownList({dataSource:[{text:o[0],value:0},{text:o[1],value:1}],dataTextField:"text",dataValueField:"value",change:function(e){var a={type:"POST",processData:!0,data:{action:"exam_category",examtype:this.value()}};i.ajax(m,a).then(function(e){var a=i.parseJSON(e);i("#examonline-category").hide().html(a.category_exam).fadeIn("fast"),i("#table-exam").hide().html(a.result).fadeIn("fast"),t(),n()})}}),i("#examonline-category").on("click","li.exam",function(e){var a=i(this).attr("id"),t=i("#exam-type").val();i(".loading-page").addClass("active"),i("#menu-tree-exam li.exam").removeClass("active"),i("#menu-tree-exam li.subject-exam").removeClass("active"),i("#menu-tree-exam li.exam").addClass("not-allow"),i(this).addClass("active"),i(".content-expand."+a).slideToggle(),i(this).children("i.rotate-icon").toggleClass("active");var n={type:"POST",processData:!0,data:{examid:a,examtype:t},contenttype:"application/json"};i.ajax(m,n).then(function(e){var a=i.parseJSON(e);i("#table-exam").hide().html(a.result).fadeIn("fast"),i(".loading-page").removeClass("active"),i("#menu-tree-exam li.exam").removeClass("not-allow")})}),i("#examonline-category").on("click","li.subject-exam",function(e){i(".loading-page").addClass("active"),i("#menu-tree-exam li.exam").removeClass("active"),i("#menu-tree-exam li.subject-exam").removeClass("active"),i(this).addClass("active");var a=i(this).attr("data-examsujbectexam"),t=l.wwwroot+"/course/modedit.php?add=quiz&type=&course=1&section=0&return=0&sr=0&examsubjectexamid="+a;i("#add-quiz").attr("href",t),i("#add-quiz").removeClass("d-none");var n={type:"POST",processData:!0,data:{examsubjectexamid:a,examtype:i("#exam-type").val()},contenttype:"application/json"};i.ajax(m,n).then(function(e){var a=i.parseJSON(e);i("#table-exam").hide().html(a.result).fadeIn("fast"),i(".loading-page").removeClass("active")})}),t(),n()})});