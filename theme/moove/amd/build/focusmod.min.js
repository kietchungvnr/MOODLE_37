define(["jquery","core/config","core/str","core/notification"],function(e,o,t,a){"use strict";var i=window.location.href;if(e(document).ready(function(){i.indexOf("course/view/")>0&&e("#sidepreopen-control").click()}),"focusmod"==r("cookie")){document.cookie="cookie=; max-Age=-1;path=/";var n=e("#focus-mod").attr("course");window.location.replace(o.wwwroot+"/course/view.php?id="+n)}function r(e){for(var o=e+"=",t=decodeURIComponent(document.cookie).split(";"),a=0;a<t.length;a++){for(var i=t[a];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(o))return i.substring(o.length,i.length)}return""}e(".open-focusmod").bind("click",function(){var a=r("cookie"),i=e(this).attr("course");t.get_string("selectcoursedata","theme_moove").then(function(o){e('[role="main"]').html('<div class="alert alert-success mb-0"><strong>'+o+"</strong></div>")}),e("#region-main").css("margin-top","20px"),e("#setting-context").removeClass("d-none"),e("#sidepreopen-control").removeClass("d-none"),"focusmod"==a?(e("body").removeClass("focusmod"),window.location.replace(o.wwwroot+"/course/view.php?id="+i),document.cookie="cookie=; max-Age=-1;path=/"):(e("body").addClass("focusmod"),e("#sidepre-blocks").hasClass("closed")||e("#sidepreopen-control").click(),e("footer,.all-header,#page-header").slideUp(),e(".navbar.focusmod").css("display","flex"),e("ul.course").css("display","none"),e("#page-content").css("margin-top","62px"),function(e,o,t){var a=new Date;a.setTime(a.getTime()+24*t*60*60*1e3);var i="expires="+a.toUTCString();document.cookie=e+"="+o+";"+i+";path=/"}("cookie","focusmod"))}),e(window).resize(function(){var o=r("cookie");e(window).width()<=1050&&"focusmod"==o&&(e(".fixed-top.focusmod .open-focusmod ").trigger("click"),e("#setting-context").removeClass("d-none"),e("#sidepreopen-control").removeClass("d-none"))}),e(".dropdown-content .card-header").click(function(){var o=e(this).attr("id");e(".card-header#"+o+" .rotate-icon").toggleClass("active"),e(".dropdown-content-2."+o).slideToggle("fast","swing")}),e(".nav-item.mid").click(function(){e(".dropdown-content").is(":empty")?alert("Không có nội dung"):e(".dropdown-content").slideToggle("fast","linear")}),e(".card-header.level2 a").each(function(){this.href===i&&(e(this).addClass("active"),e(this).parents("div.dropdown-content-2").addClass("active"),e(".mid .nav-link.focusmod").html(e(this).text()+'<i class="fa fa-angle-down rotate-icon ml-2"></i>'))}),e(".nav-link.prev").click(function(){var o=e(".card-header.level2 a.active").parents("div").prev().children("a").attr("href");e(this).attr("href",o)}),e(".nav-link.next").click(function(){var o=e(".card-header.level2 a.active").parents("div").next().children("a").attr("href");e(this).attr("href",o)}),e("[data-focusmode-url]").click(function(o){var t=e(this),a=t.attr("data-focusmode-url"),i=t.attr("data-mod-type");if(e("[role=main]").addClass("d-none"),e("#course-content").addClass("d-none"),e("#region-main .loading-page").addClass("active"),e("#page-content").attr("style","margin-left:0;margin-right:0"),e("#region-main-box").attr("style","padding:0!important;margin-top:40px"),e("#page.container-fluid").attr("style","padding: 0!important"),e("#setting-context").addClass("d-none"),e("#sidepreopen-control").addClass("d-none"),e("#sidepre-blocks").addClass("d-none"),"forum"==i)var n='<iframe id="mod-iframe" src="'+a+'" width="100%" height="768" frameBorder="0"></iframe>';else n='<iframe id="mod-iframe" src="'+a+'" onload="$(this).height($(this.contentWindow.document.body).find(\'#page-wrapper\').first().height());" width="100%" height="100%" frameBorder="0"></iframe>';e("#mod-view").html(n),e("#mod-iframe").on("load",function(){setTimeout(function(){try{if("resource"==i||"forum"==i){var o=e("body").height()-77;e("#mod-iframe").height(o)}e("#region-main .loading-page").removeClass("active")}catch(e){(e.message.indexOf("Blocked a frame with origin")>-1||e.message.indexOf("from accessing a cross-origin frame.")>-1)&&console.log("Same origin Iframe error found!!!")}},1e3)})}),t.get_strings([{key:"general",component:"theme_moove"}]).then(function(o){""==e("div.card-header.level1:first-child() a").text()&&e("div.card-header.level1:first-child() a").append(o[0])}),e("div.card-header.level1").each(function(){var o=e(this).attr("id");e(".dropdown-content-2."+o).is(":empty")&&e(this).hide()}),e(".card-header.level2 a").hasClass("active")?(e(".card-header.level2 a.active").parents("div.level2").is(":first-child")&&e(".nav-link.prev").addClass("disable"),e(".card-header.level2 a.active").parents("div.level2").is(":last-child")&&e(".nav-link.next").addClass("disable")):e(".nav-link.next,.nav-link.prev").addClass("disable"),e(".card-header.level2 a").each(function(){e(this).attr("href").indexOf("/mod/url/")>0&&e(this).attr("target","_blank")})});